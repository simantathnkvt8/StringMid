# StringMid
EndIf     $tail = Round("0." &amp; $tail, $round)     If $tail = 1 Then         $int = $int + 1         $tail = StringFormat("%0" &amp; $round &amp; "s", "0")         $mod = Mod(StringLen($int), 3)         If $mod = 0 Then             $int = StringRegExpReplace($int, "(\d{1,3})", ".$1")             If $round = 0 Then                 Return $sign &amp; StringRight($int, StringLen($int) - 1)             Else                 Return $sign &amp; StringRight($int, StringLen($int) - 1) &amp; "," &amp; StringMid(StringFormat("%f", $tail), 3, $round)             EndIf         ElseIf $mod = 2 Or $mod = 1 Then             $int1 = StringLeft($int, $mod)             $int2 = StringRight($int, StringLen($int) - $mod)             If $round = 0 Then                 Return $sign &amp; $int1 &amp; StringRegExpReplace($int2, "(\d{1,3})", ".$1")             Else                 Return $sign &amp; $int1 &amp; StringRegExpReplace($int2, "(\d{1,3})", ".$1") &amp; "," &amp; StringMid(StringFormat("%f", $tail), 3, $round)             EndIf         EndIf     Else
